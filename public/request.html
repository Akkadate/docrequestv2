<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="request.title">‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ - ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
  <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏≠‡∏ô‡∏ï‡πå Prompt ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏≠‡∏ô‡∏ï‡πå Noto Sans SC ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô -->[
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="#" data-i18n="navbar.title">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html" data-i18n="navbar.home">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="dashboard.html" data-i18n="navbar.dashboard">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="request.html" data-i18n="navbar.request">‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="status.html" data-i18n="navbar.status">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</a>
          </li>
        </ul>
        <div class="language-selector d-flex me-3">
          <button class="btn btn-sm btn-outline-light me-2" data-lang="th">‡πÑ‡∏ó‡∏¢</button>
          <button class="btn btn-sm btn-outline-light me-2" data-lang="en">English</button>
          <button class="btn btn-sm btn-outline-light" data-lang="zh">‰∏≠Êñá</button>
        </div>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="#" id="logout" data-i18n="navbar.logout">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <h2 class="mb-4" data-i18n="request.header">‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
    
    <div class="row">
      <div class="col-md-8">
        <div class="card mb-4">
          <div class="card-body">
            <div id="alert-container"></div>
            <form id="document-request-form">
              <!-- Document Selection Table -->
              <div class="mb-4">
                <label class="form-label required" data-i18n="request.documentType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                <div class="table-responsive">
                  <table class="table table-hover" id="document-selection-table">
                    <thead>
                      <tr>
                        <th data-i18n="request.documentName">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</th>
                        <th data-i18n="request.unitPrice">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô</th>
                        <th data-i18n="request.quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                        <th data-i18n="request.subtotal">‡∏£‡∏ß‡∏°</th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody id="selected-documents">
                      <!-- Selected documents will be added here -->
                    </tbody>
                  </table>
                </div>
                <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#addDocumentModal">
                  <i class="bi bi-plus-circle"></i> <span data-i18n="request.addDocument">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
                </button>
              </div>
              
              <div class="mb-3">
                <label class="form-label required" data-i18n="request.deliveryMethod">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="delivery_method" id="pickup" value="pickup" checked>
                  <label class="form-check-label" for="pickup" data-i18n="request.pickup">‡∏£‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="delivery_method" id="mail" value="mail">
                  <label class="form-check-label" for="mail" data-i18n="request.mail">‡∏£‡∏±‡∏ö‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
                </div>
              </div>
              
              <div id="address-container" class="mb-3" style="display: none;">
                <label for="address" class="form-label required" data-i18n="request.address">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</label>
                <textarea class="form-control" id="address" rows="3" data-i18n-placeholder="request.addressPlaceholder"></textarea>
              </div>
              
           <div id="urgent-container" class="mb-3">
  <div class="form-check">
    <input class="form-check-input" type="checkbox" id="urgent">
    <label class="form-check-label" for="urgent" data-i18n="request.urgent">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô (‡πÄ‡∏û‡∏¥‡πà‡∏° 50 ‡∏ö‡∏≤‡∏ó‡∏ï‡πà‡∏≠‡∏â‡∏ö‡∏±‡∏ö)</label>
  </div>
</div>
              
              <div class="mb-3">
                <label for="payment_slip" class="form-label required" data-i18n="request.paymentSlip">‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
                <input type="file" class="form-control" id="payment_slip" accept="image/*,.pdf" required>
                <div class="form-text" data-i18n="request.paymentSlipInfo">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠ PDF)</div>
              </div>
              
              <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary" data-i18n="request.submitButton">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="card mb-4">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0" data-i18n="request.summary">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h5>
          </div>
          <div class="card-body">
            <div id="summary-container">
              <p data-i18n="request.emptySelection">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</p>
            </div>
            <hr>
            <div class="d-flex justify-content-between">
              <strong data-i18n="request.documentSubtotal">‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏ß‡∏°:</strong>
              <span id="documents-subtotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>
            <div id="shipping-fee-container" class="d-flex justify-content-between mt-2" style="display: none;">
              <strong data-i18n="request.shippingFee">‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</strong>
              <span id="shipping-fee">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>
            <div id="urgent-fee-container" class="d-flex justify-content-between mt-2" style="display: none;">
              <strong data-i18n="request.urgentService">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô:</strong>
              <span id="urgent-fee">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>
            <div class="d-flex justify-content-between mt-3 pt-2 border-top fw-bold">
              <strong data-i18n="request.totalPrice">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°:</strong>
              <span id="total-price">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>
          </div>
        </div>
        
        <div class="card mb-4">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0" data-i18n="request.payment">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h5>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <div class="qr-code-container">
                <img src="img/qr-payment.png" alt="QR Code" class="img-fluid">
              </div>
              <p class="text-center mt-2" data-i18n="request.scanQR">‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
            </div>
            <div class="mb-3">
              <p data-i18n="request.bankTransfer">‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£:</p>
              <p>
                <strong data-i18n="request.bankName">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£:</strong> <span id="bank-name">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏£‡∏∏‡∏á‡πÑ‡∏ó‡∏¢</span><br>
                <strong data-i18n="request.accountNumber">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</strong> <span id="account-number">1234567890</span><br>
                <strong data-i18n="request.accountName">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</strong> <span id="account-name">‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ô‡∏≠‡∏£‡πå‡∏ó‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ -->
  <div class="modal fade" id="addDocumentModal" tabindex="-1" aria-labelledby="addDocumentModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="addDocumentModalLabel" data-i18n="request.addDocument">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="modal-alert-container"></div>
          <form id="add-document-form">
            <div class="mb-3">
              <label for="modal-document-type" class="form-label required" data-i18n="request.documentType">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
              <select class="form-select" id="modal-document-type" required>
                <option value="" selected disabled data-i18n="request.selectDocumentType">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="modal-document-quantity" class="form-label required" data-i18n="request.quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
              <input type="number" class="form-control" id="modal-document-quantity" min="1" value="1" required>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n="request.cancel">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="button" class="btn btn-primary" id="add-document-button" data-i18n="request.addDocument">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
        </div>
      </div>
    </div>
  </div>

 
<!-- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á -->
<button id="test-calculation" style="position: fixed; bottom: 10px; right: 10px; z-index: 9999; background: #f00; color: white; padding: 5px 10px;">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>

<script>
  // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
  document.addEventListener('DOMContentLoaded', () => {
    const testButton = document.getElementById('test-calculation');
    if (testButton) {
      testButton.addEventListener('click', () => {
        console.log('Test button clicked');
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
        window.selectedDocuments = [
          { id: '1', name: '‡πÉ‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤', price: 100, quantity: 2, subtotal: 200 },
          { id: '2', name: '‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤', price: 100, quantity: 1, subtotal: 100 }
        ];
        
        console.log('Created test documents:', window.selectedDocuments);
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        window.updateDocumentTable();
        
        // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
        const pickupRadio = document.getElementById('pickup');
        if (pickupRadio) {
          pickupRadio.checked = true;
          console.log('Set pickup radio to checked');
          
          // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô
          const urgentCheckbox = document.getElementById('urgent');
          if (urgentCheckbox) {
            urgentCheckbox.checked = true;
            console.log('Set urgent checkbox to checked');
            
            // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤
            window.calculatePrice();
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ã‡∏•
            console.log('Test calculation completed');
            console.log('Selected documents:', window.selectedDocuments);
            console.log('Total documents:', window.selectedDocuments.reduce((count, doc) => count + doc.quantity, 0));
            console.log('Urgent checkbox checked:', urgentCheckbox.checked);
            console.log('Delivery method:', pickupRadio.value);
            
            const urgentFeeElement = document.getElementById('urgent-fee');
            console.log('Urgent fee displayed:', urgentFeeElement ? urgentFeeElement.textContent : 'Element not found');
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó DOM ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô)
            if (urgentFeeElement) {
              const totalDocuments = window.selectedDocuments.reduce((count, doc) => count + doc.quantity, 0);
              const urgentFee = 50 * totalDocuments;
              urgentFeeElement.textContent = window.formatCurrency(urgentFee, window.currentLang || 'th');
              console.log('Manually updated urgent fee to:', urgentFeeElement.textContent);
              
              // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏î‡πâ‡∏ß‡∏¢
              const totalPriceElement = document.getElementById('total-price');
              if (totalPriceElement) {
                const docSubtotal = window.selectedDocuments.reduce((total, doc) => total + doc.subtotal, 0);
                const totalPrice = docSubtotal + urgentFee;
                totalPriceElement.textContent = window.formatCurrency(totalPrice, window.currentLang || 'th');
                console.log('Manually updated total price to:', totalPriceElement.textContent);
              }
            }
          }
        }
      });
    }
  });
</script>
  <script>
  // ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô
  document.addEventListener('DOMContentLoaded', function() {
    // ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô
    setTimeout(function() {
      console.log('üî• EMERGENCY FIX SCRIPT RUNNING');
      
      // ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô calculatePrice ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
      if (typeof window.calculatePrice === 'function') {
        const originalCalculatePrice = window.calculatePrice;
        
        window.calculatePrice = function() {
          console.log('üî• Using fixed calculatePrice function');
          
          // ‡∏£‡∏±‡∏ö‡∏≠‡∏¥‡∏•‡∏¥‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ
          const documentsSubtotalElement = document.getElementById('documents-subtotal');
          const shippingFeeElement = document.getElementById('shipping-fee');
          const urgentFeeElement = document.getElementById('urgent-fee');
          const totalPriceElement = document.getElementById('total-price');
          const shippingFeeContainer = document.getElementById('shipping-fee-container');
          const urgentFeeContainer = document.getElementById('urgent-fee-container');
          
          // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥
          const result = originalCalculatePrice();
          
          // ‡πÅ‡∏ï‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏°‡πà
          const totalDocuments = window.selectedDocuments.reduce((count, doc) => count + doc.quantity, 0);
          const deliveryMethod = document.querySelector('input[name="delivery_method"]:checked').value;
          const isUrgent = document.getElementById('urgent').checked;
          
          if (isUrgent && deliveryMethod === 'pickup') {
            const urgentFee = 50 * totalDocuments;
            console.log('üî• Fixed urgent fee:', urgentFee, '(', totalDocuments, 'x 50)');
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó DOM
            if (urgentFeeElement) {
              urgentFeeElement.textContent = window.formatCurrency ? window.formatCurrency(urgentFee, window.currentLang || 'th') : (urgentFee + '.00 ‡∏ö‡∏≤‡∏ó');
            }
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
            const documentSubtotal = window.selectedDocuments.reduce((total, doc) => total + doc.subtotal, 0);
            const shippingFee = deliveryMethod === 'mail' ? 200 : 0;
            const totalPrice = documentSubtotal + shippingFee + urgentFee;
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°
            if (totalPriceElement) {
              totalPriceElement.textContent = window.formatCurrency ? window.formatCurrency(totalPrice, window.currentLang || 'th') : (totalPrice + '.00 ‡∏ö‡∏≤‡∏ó');
            }
          }
          
          return result;
        };
        
        console.log('üî• Fixed calculatePrice function installed');
        
        // ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô updateSummary ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà
        if (typeof window.updateSummary === 'function') {
          const originalUpdateSummary = window.updateSummary;
          
          window.updateSummary = function(deliveryMethod, isUrgent) {
            console.log('üî• Using fixed updateSummary function');
            
            // ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥‡∏Å‡πà‡∏≠‡∏ô
            originalUpdateSummary(deliveryMethod, isUrgent);
            
            // ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡πÉ‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            if (isUrgent && deliveryMethod === 'pickup') {
              const summaryContainer = document.getElementById('summary-container');
              if (summaryContainer) {
                const totalDocuments = window.selectedDocuments.reduce((count, doc) => count + doc.quantity, 0);
                const urgentFee = 50 * totalDocuments;
                
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô‡πÉ‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                const urgentServiceElement = summaryContainer.querySelector('[data-urgent-service]');
                if (urgentServiceElement) {
                  urgentServiceElement.innerHTML = `${window.formatCurrency ? window.formatCurrency(urgentFee, window.currentLang || 'th') : (urgentFee + '.00 ‡∏ö‡∏≤‡∏ó')} (${totalDocuments} ‡∏â‡∏ö‡∏±‡∏ö x 50 ‡∏ö‡∏≤‡∏ó)`;
                } else {
                  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                  const urgentServiceHTML = `
                    <div class="mb-3" data-urgent-service="true">
                      <strong>${i18n && i18n[window.currentLang] ? i18n[window.currentLang].request.urgentService : '‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô'}:</strong>
                      <div>${window.formatCurrency ? window.formatCurrency(urgentFee, window.currentLang || 'th') : (urgentFee + '.00 ‡∏ö‡∏≤‡∏ó')} (${totalDocuments} ‡∏â‡∏ö‡∏±‡∏ö x 50 ‡∏ö‡∏≤‡∏ó)</div>
                    </div>
                  `;
                  
                  // ‡πÅ‡∏ó‡∏£‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                  const deliveryMethodElement = summaryContainer.querySelector('[data-delivery-method]');
                  if (deliveryMethodElement) {
                    deliveryMethodElement.insertAdjacentHTML('afterend', urgentServiceHTML);
                  } else {
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÉ‡∏´‡πâ‡πÅ‡∏ó‡∏£‡∏Å‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏î‡∏¥‡∏°
                    summaryContainer.innerHTML += urgentServiceHTML;
                  }
                }
              }
            }
          };
          
          console.log('üî• Fixed updateSummary function installed');
        }
      }
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô
      const urgentCheckbox = document.getElementById('urgent');
      if (urgentCheckbox) {
        urgentCheckbox.addEventListener('change', function() {
          console.log('üî• Urgent checkbox changed to:', this.checked);
          if (this.checked) {
            // ‡∏£‡∏≠‡πÉ‡∏´‡πâ calculatePrice ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
            setTimeout(function() {
              const totalDocuments = window.selectedDocuments.reduce((count, doc) => count + doc.quantity, 0);
              const expectedUrgentFee = 50 * totalDocuments;
              
              const urgentFeeElement = document.getElementById('urgent-fee');
              if (urgentFeeElement) {
                const displayedFee = urgentFeeElement.textContent;
                console.log('üî• Checking urgent fee calculation:', {
                  expected: expectedUrgentFee,
                  displayed: displayedFee
                });
                
                // ‡∏ñ‡πâ‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
                if (!displayedFee.includes(expectedUrgentFee.toString())) {
                  console.log('üî• Urgent fee calculation is incorrect, fixing...');
                  urgentFeeElement.textContent = window.formatCurrency ? window.formatCurrency(expectedUrgentFee, window.currentLang || 'th') : (expectedUrgentFee + '.00 ‡∏ö‡∏≤‡∏ó');
                  console.log('üî• Fixed urgent fee display to:', urgentFeeElement.textContent);
                  
                  // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏î‡πâ‡∏ß‡∏¢
                  const totalPriceElement = document.getElementById('total-price');
                  if (totalPriceElement) {
                    const documentSubtotal = window.selectedDocuments.reduce((total, doc) => total + doc.subtotal, 0);
                    const deliveryMethod = document.querySelector('input[name="delivery_method"]:checked').value;
                    const shippingFee = deliveryMethod === 'mail' ? 200 : 0;
                    const totalPrice = documentSubtotal + shippingFee + expectedUrgentFee;
                    
                    totalPriceElement.textContent = window.formatCurrency ? window.formatCurrency(totalPrice, window.currentLang || 'th') : (totalPrice + '.00 ‡∏ö‡∏≤‡∏ó');
                    console.log('üî• Fixed total price display to:', totalPriceElement.textContent);
                  }
                }
              }
            }, 500);
          }
        });
      }
      
      console.log('üî• EMERGENCY FIX SCRIPT COMPLETED');
    }, 2000); // ‡∏£‡∏≠ 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏™‡∏£‡πá‡∏à
  });
</script>
   <footer class="footer mt-5 py-3 bg-light">
    <div class="container text-center">
      <p>test</p>
      <span class="text-muted" data-i18n="footer.copyright">
        ¬© 2025 ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ô‡∏≠‡∏£‡πå‡∏ó‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û xxx
      </span>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/language.js"></script>
  <script src="js/main.js"></script>
  <script src="js/request.js"></script>
</body>
</html>
